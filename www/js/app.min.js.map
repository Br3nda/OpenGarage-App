{"version":3,"sources":["app.min.js"],"names":["angular","module","run","$state","$ionicPlatform","$ionicScrollDelegate","$ionicHistory","$location","$document","$window","$rootScope","$ionicLoading","$ionicPopup","$timeout","Utils","ready","open","url","window","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","StatusBar","styleLightContent","backgroundColorByHexString","element","on","scrollTop","navigator","splashscreen","hide","err","connected","version","appVersion","loadingCount","controllers","$on","e","data","canceller","resolve","noop","show","template","title","checkNewController","firstLoadHandler","event","preventDefault","storage","get","JSON","parse","activeController","go","updateController","$broadcast","innerWidth","document","getElementById","width","config","$stateProvider","$urlRouterProvider","$httpProvider","$compileProvider","$ionicConfigProvider","test","userAgent","platform","spinner","icon","backButton","previousTitleText","text","scrolling","jsScrolling","aHrefSanitizationWhitelist","imgSrcSanitizationWhitelist","state","abstract","templateUrl","controller","views","menuContent","checkValid","$q","$filter","total","length","filterFilter","invalidOrg","mac","remove","reject","set","stringify","interceptors","push","$injector","request","suppressLoader","defer","timeout","promise","retryCount","response","responseError","error","$$state","status","canceled","$http","retryFailed","forwardCache","$scope","$ionicModal","showDelete","image","cropped","index","fileInput","fromTemplateUrl","scope","then","modal","crop","hasCamera","camera","getPicture","setController","nextViewOptions","historyRoot","deleteController","indexOf","splice","moveItem","item","fromIndex","toIndex","getTime","timestamp","Date","toLocaleString","selectPhoto","$event","stopPropagation","$apply","parent","reset","one","file","files","type","match","reader","FileReader","onload","evt","target","result","readAsDataURL","click","uploadPhoto","getLogs","reply","isLocal","logs","settings","changePassword","restart","restartController","submit","saveOptions","alert","getControllerOptions","mod","fwv","$ionicActionSheet","$ionicSideMenuDelegate","showAddController","buttons","titleText","cancelText","buttonClicked","showAddBlynk","closeMenu","toggleLeft","interval","toggleDoor","clearInterval","setInterval","factory","isFireFox","isIE","query","callback","i","hasOwnProperty","localStorage","getItem","setItem","removeItem","intToIP","int","getControllerSettings","ip","token","auth","method","headers","Content-Type","encodeURIComponent","filter","name","door","parseInt","pins","pin","value","dist","rcnt","lastUpdate","showLoader","copy","save","extend","when","addController","password","pop","split","join","ssids","$new","connectNewController","animation","ssid","setTimeout","saveNewController","scanLocalNetwork","networkinterface","getIPAddress","router","baseip","check","matches","queue","all","requestPassword","prompt","inputType","inputPlaceholder","HTMLElement","prototype","this","ownerDocument","createEvent","initMouseEvent","defaultView","dispatchEvent","canScan","scan","foundControllers","popup","close","onTap","isValid","confirm","params","paramSerializer","pwd","nkey","ckey","sort","a","b"],"mappings":"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","file":"app.min.js","sourcesContent":["/* global angular */\n\n// OpenGarage\n// Controllers are found in controllers.js and utilities are located in utils.js\nangular.module( \"opengarage\", [ \"ionic\", \"uiCropper\", \"opengarage.controllers\", \"opengarage.utils\" ] )\n\t.run( function( $state, $ionicPlatform, $ionicScrollDelegate, $ionicHistory, $location, $document, $window, $rootScope, $ionicLoading, $ionicPopup, $timeout, Utils ) {\n\n\t\t// Ready function fires when the DOM is ready and after deviceready event is fired if Cordova is being used\n\t\t$ionicPlatform.ready( function() {\n\n\t\t\t// Map inAppBrowser to rootScope\n\t\t\t$rootScope.open = function( url ) {\n\t\t\t\twindow.open( url, \"_blank\", \"toolbarposition=top\" );\n\t\t\t};\n\n\t\t\t// Hide the accessory bar by default (remove this to show the accessory bar above the keyboard\n\t\t\t// for form inputs)\n\t\t\tif ( window.cordova && window.cordova.plugins && window.cordova.plugins.Keyboard && window.cordova.plugins.Keyboard.hideKeyboardAccessoryBar ) {\n\t\t\t\twindow.cordova.plugins.Keyboard.hideKeyboardAccessoryBar( true );\n\t\t\t}\n\t\t\tif ( window.StatusBar ) {\n\n\t\t\t\t// Use white text/icons on the status bar\n\t\t        window.StatusBar.styleLightContent();\n\n\t\t        //Change the status bar color to match the header\n                window.StatusBar.backgroundColorByHexString( \"#444\" );\n\n\t\t        // Scroll to the top of the page when the status bar is tapped\n\t\t\t\tangular.element( $window ).on( \"statusTap\", function() {\n\t\t\t\t\t$ionicScrollDelegate.scrollTop();\n\t\t        } );\n\t\t\t}\n\n\t\t    // Hide the splash screen after 500ms of the app being ready\n\t\t    $timeout( function() {\n\t\t        try {\n\t\t            navigator.splashscreen.hide();\n\t\t        } catch ( err ) {}\n\t\t    }, 500 );\n\t\t} );\n\n\t\t// Define connected state of current controller\n\t\t$rootScope.connected = false;\n\n\t\t// Define version, build number and debug state\n\t\t$rootScope.version = window.appVersion;\n\n\t    // Define total loading requests\n\t    $rootScope.loadingCount = 0;\n\n\t    // Initialize controllers array\n\t    $rootScope.controllers = [];\n\n\t\t// Automatically show a loading message on any AJAX request\n\t\t$rootScope.$on( \"loading:show\", function( e, data ) {\n\n\t\t\t$rootScope.loadingCount++;\n\t\t\t$rootScope.canceller = data ? data.canceller.resolve : angular.noop;\n\t\t\t$ionicLoading.show( {\n\t\t\t\ttemplate: \"<ion-spinner></ion-spinner><br>One moment please<br><button class='button white icon-left ion-ios-close-outline button-clear' ng-click='$root.canceller()'>Cancel</button>\"\n\t\t\t} );\n\t\t} );\n\n\t\t// Automatically hide the loading message after an AJAX request\n\t\t$rootScope.$on( \"loading:hide\", function() {\n\n\t\t\t$rootScope.loadingCount--;\n\t\t\tif ( $rootScope.loadingCount <= 0 ) {\n\t\t\t\t$rootScope.loadingCount = 0;\n\t\t\t\t$ionicLoading.hide();\n\t\t\t}\n\t\t} );\n\n\t\t// Keep the page title locked as the app name\n\t\t$rootScope.$on( \"$ionicView.afterEnter\", function() {\n\t\t\t$document[ 0 ].title = \"OpenGarage\";\n\t\t} );\n\n\t\tangular.element( $document ).on( \"resume\", function() {\n\t\t\t$timeout( Utils.checkNewController, 100 );\n\t\t} );\n\n\t\t// Handle loading of the first page\n\t\tvar firstLoadHandler = $rootScope.$on( \"$stateChangeStart\", function( event ) {\n\n\t\t\t// Unbind event handler so this check is only performed on the first app load\n\t\t    firstLoadHandler();\n\n\t\t    // Prevent any page change from occurring\n\t        event.preventDefault();\n\n\t\t    Utils.storage.get( [ \"activeController\", \"controllers\" ], function( data ) {\n\n\t\t\t\ttry {\n\t\t\t\t\t$rootScope.controllers = JSON.parse( data.controllers );\n\t\t\t\t\t$rootScope.activeController = JSON.parse( data.activeController );\n\t\t\t\t} catch ( err ) {}\n\n\t\t\t\tif ( !$rootScope.controllers ) {\n\t\t\t\t\t$rootScope.controllers = [];\n\t\t\t\t}\n\n\t\t\t\t// Restore the active controller, if available\n\t\t        if ( $rootScope.activeController && typeof $rootScope.activeController === \"object\" ) {\n\n\t\t\t\t\t// If a user object is cached, proceed to load the app while updating user object in the background\n\t\t\t\t\t$state.go( \"app.home\" );\n\n\t\t\t\t\tUtils.updateController();\n\t\t        } else {\n\t\t\t\t\t$state.go( \"app.controllerSelect\" );\n\t\t        }\n\t\t    } );\n\n\t\t    Utils.checkNewController();\n\t\t} );\n\n\t\t// Resize the main content view to fit when the window changes size\n\t\tangular.element( window ).on( \"resize\", function() {\n\t\t\t$rootScope.$broadcast( \"window:resize\" );\n\t\t\tif ( window.innerWidth > 768 ) {\n\t\t\t\tdocument.getElementById( \"mainContent\" ).width = window.innerWidth - 275;\n\t\t\t}\n\t\t} );\n\t} )\n\n\t.config( function( $stateProvider, $urlRouterProvider, $httpProvider, $compileProvider, $ionicConfigProvider ) {\n\n\t\tif ( /MSIE\\s|Trident\\/|Edge\\//.test( window.navigator.userAgent ) ) {\n\n\t\t\t// Change the default spinner for IE to android which has JS based animation\n\t\t\t$ionicConfigProvider.platform.default.spinner.icon( \"android\" );\n\t\t}\n\n\t\t// Change the back text to always say 'Back'\n\t\t$ionicConfigProvider.backButton.previousTitleText( false ).text( \"Back\" );\n\n\t\t// Use native scrolling for FireFox\n\t\tif ( /Firefox/.test( navigator.userAgent ) ) {\n\t\t\t$ionicConfigProvider.scrolling.jsScrolling( false );\n\t\t}\n\n\t\t// Modify Ionic's allowed href protocols to allow Firefox, Blackberry, iOS and Chrome support\n\t\t$compileProvider.aHrefSanitizationWhitelist( /^\\s*(https?|ftp|mailto|chrome-extension|app|local|file):/ );\n\n\t\t// Modify Ionic's allowed image source protocols\n\t\t$compileProvider.imgSrcSanitizationWhitelist( /^\\s*(https?|ftp|file|content|blob|ms-appx|x-wmapp0|chrome-extension|app|local):|data:image\\// );\n\n\t\t// Define all available routes and their associated controllers\n\t\t$stateProvider\n\n\t\t\t// Used as the parent route after authentication is complete allowing the same header\n\t\t\t// and side menu's to be used throughout all child views\n\t\t\t.state( \"app\", {\n\t\t\t\turl: \"/app\",\n\t\t\t\tabstract: true,\n\t\t\t\ttemplateUrl: \"templates/menu.html\",\n\t\t\t\tcontroller: \"MenuCtrl\"\n\t\t\t} )\n\n\t\t\t.state( \"app.home\", {\n\t\t\t\turl: \"/home\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/home.html\",\n\t\t\t\t\t\tcontroller: \"HomeCtrl\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcheckValid: function( $timeout, $q, $state, $rootScope, $filter, Utils ) {\n\t\t\t\t\t\tvar total = $rootScope.controllers.length,\n\t\t\t\t\t\t\tfilterFilter = $filter( \"filter\" ),\n\t\t\t\t\t\t\tinvalidOrg = ( $rootScope.activeController && filterFilter( $rootScope.controllers, { \"mac\": $rootScope.activeController.mac } ).length === 0 ) ? true : false;\n\n\t\t\t\t\t\tif ( !$rootScope.activeController && total === 1 ) {\n\t\t\t\t\t\t\t$rootScope.activeController = $rootScope.controllers[ 0 ];\n\t\t\t\t\t\t\tUtils.updateController();\n\t\t\t\t\t\t\tUtils.storage.set( { activeController: JSON.stringify( $rootScope.activeController ) } );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( !$rootScope.activeController || invalidOrg ) {\n\n\t\t\t\t\t\t\tdelete $rootScope.activeController;\n\t\t\t\t\t\t\tUtils.storage.remove( \"activeController\" );\n\n\t\t\t\t\t\t\t// If the active controller is not found in the controller list, show the select controller screen\n\t\t\t\t\t\t\t$timeout( function() {\n\t\t\t\t\t\t\t\t$state.go( \"app.controllerSelect\" );\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\treturn $q.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t.state( \"app.controllerSelect\", {\n\t\t\t\turl: \"/controllerSelect\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/controllerSelect.html\",\n\t\t\t\t\t\tcontroller: \"ControllerSelectCtrl\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t.state( \"app.history\", {\n\t\t\t\turl: \"/history\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/history.html\",\n\t\t\t\t\t\tcontroller: \"HistoryCtrl\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcheckValid: function( $rootScope, $q ) {\n\t\t\t\t\t\tif ( !$rootScope.activeController ) {\n\t\t\t\t\t\t\treturn $q.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t.state( \"app.settings\", {\n\t\t\t\turl: \"/settings\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/settings.html\",\n\t\t\t\t\t\tcontroller: \"SettingsCtrl\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcheckValid: function( $rootScope, $q ) {\n\t\t\t\t\t\tif ( !$rootScope.activeController ) {\n\t\t\t\t\t\t\treturn $q.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t.state( \"app.help\", {\n\t\t\t\turl: \"/help\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/help.html\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t// Defines the otherwise route which will redirect any invalid URL back to the start page\n\t\t\t.state( \"otherwise\", {\n\t\t\t\turl: \"*path\",\n\t\t\t\ttemplate: \"\",\n\t\t\t\tcontroller: function( $state, $rootScope ) {\n\n\t\t\t\t\tif ( $rootScope.activeController ) {\n\t\t\t\t\t\t$state.go( \"app.home\" );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$state.go( \"app.controllerSelect\" );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t// Add an HTTP interceptor\n\t\t$httpProvider.interceptors.push( function( $rootScope, $q, $injector ) {\n\t\t\treturn {\n\t\t\t\trequest: function( config ) {\n\n\t\t\t\t\t// When an AJAX request to the controller is started, fire an event to show a loading message\n\t\t\t\t\tif ( !config.suppressLoader ) {\n\n\t\t\t\t\t\t// Change timeout to a promise we can cancel\n\t\t\t\t\t\tvar canceller = $q.defer();\n\n\t\t\t\t\t\t// Set the timeout to the canceller promise\n\t\t\t\t\t\tconfig.timeout = canceller.promise;\n\n\t\t\t\t\t\t// Set the current retry count to 0\n\t\t\t\t\t\tif ( typeof config.retryCount !== \"number\" ) {\n\t\t\t\t\t\t\tconfig.retryCount = 0;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$rootScope.$broadcast( \"loading:show\", { canceller: canceller } );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn config;\n\t\t\t\t},\n\t\t\t\tresponse: function( response ) {\n\n\t\t\t\t\t// If the request is to the controller, broadcast a hide loading message\n\t\t\t\t\tif ( !response.config.suppressLoader ) {\n\t\t\t\t\t\t$rootScope.$broadcast( \"loading:hide\" );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn response;\n\t\t\t\t},\n\t\t\t\tresponseError: function( error ) {\n\n\t\t\t\t\t// If the timeout value is an object and is resolved, mark request as user canceled\n\t\t\t\t\tif ( error.config.timeout && error.config.timeout.$$state && error.config.timeout.$$state.status === 1 ) {\n\t\t\t\t\t\terror.canceled = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !error.config.suppressLoader ) {\n\t\t\t\t\t\t$rootScope.$broadcast( \"loading:hide\" );\n\t\t\t\t\t}\n\n\t\t\t\t\t// If the request timed out and is not user canceled, retry the request up to three times\n\t\t\t\t\tif ( error.status <= 0 && !error.canceled ) {\n\t\t\t\t\t\tif ( error.config.retryCount < 3 ) {\n\t\t\t\t\t\t\tvar $http = $injector.get( \"$http\" );\n\n\t\t\t\t\t\t\terror.config.retryCount++;\n\n\t\t\t\t\t\t\t// Return the new promise object\n\t\t\t\t\t\t\treturn $http( error.config );\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// After three timeouts, assume the network is down\n\t\t\t\t\t\t\terror.retryFailed = true;\n\t\t\t\t\t\t\terror.canceled = true;\n\n\t\t\t\t\t\t\treturn $q.reject( error );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn $q.reject( error );\n\t\t\t\t}\n\t\t\t};\n\t\t} );\n\n\t\t// Inform Ionic we want to cache forward views\n\t\t$ionicConfigProvider.views.forwardCache( true );\n\t} );\n\n/* global angular */\n\nangular.module( \"opengarage.controllers\", [ \"opengarage.utils\" ] )\n\n\t.controller( \"ControllerSelectCtrl\", function( $scope, $state, $rootScope, $timeout, $filter, $ionicModal, $ionicHistory, Utils ) {\n\t\t$scope.data = {\n\t\t\tshowDelete: false,\n\t\t\timage: false,\n\t\t\tcropped: false,\n\t\t\tindex: false\n\t\t};\n\n\t\tvar fileInput = angular.element( document.getElementById( \"photoUpload\" ) );\n\n\t\t$ionicModal.fromTemplateUrl( \"templates/crop.html\", {\n\t\t\tscope: $scope\n\t\t} ).then( function( modal ) {\n\t\t\t$scope.crop = modal;\n\t\t} );\n\n\t\t$scope.hasCamera = navigator.camera && navigator.camera.getPicture ? true : false;\n\n\t\t$scope.setController = function( index ) {\n\t\t\t$rootScope.activeController = $rootScope.controllers[ index ];\n\t\t\t$rootScope.connected = false;\n\t\t\tUtils.updateController();\n\t\t\tUtils.storage.set( { activeController: JSON.stringify( $rootScope.activeController ) } );\n\n\t\t\t$ionicHistory.nextViewOptions( {\n\t\t\t\thistoryRoot: true\n\t\t\t} );\n\n\t\t\t$state.go( \"app.home\" );\n\t\t};\n\n\t\t$scope.deleteController = function( index ) {\n\t\t\tif ( $rootScope.controllers.indexOf( ( $filter( \"filter\" )( $rootScope.controllers, { \"mac\": $rootScope.activeController.mac } ) || [] )[ 0 ] ) === index ) {\n\t\t\t\tdelete $rootScope.activeController;\n\t\t\t\tUtils.storage.remove( \"activeController\" );\n\t\t\t}\n\n\t\t\t$rootScope.controllers.splice( index, 1 );\n\t\t\tUtils.storage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t};\n\n\t\t$scope.moveItem = function( item, fromIndex, toIndex ) {\n\t\t\t$rootScope.controllers.splice( fromIndex, 1 );\n\t\t\t$rootScope.controllers.splice( toIndex, 0, item );\n\t\t\tUtils.storage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t};\n\n\t\t$scope.getTime = function( timestamp ) {\n\t\t\treturn new Date( timestamp ).toLocaleString();\n\t\t};\n\n\t\t$scope.selectPhoto = function( $event, index ) {\n\t\t\t$event.stopPropagation();\n\n\t\t\tif ( $scope.data.showDelete ) {\n\t\t\t\tif ( $rootScope.controllers.indexOf( ( $filter( \"filter\" )( $rootScope.controllers, { \"mac\": $rootScope.activeController.mac } ) || [] )[ 0 ] ) === index ) {\n\t\t\t\t\tdelete $rootScope.activeController.image;\n\t\t\t\t\tUtils.storage.set( { activeController: JSON.stringify( $rootScope.activeController ) } );\n\t\t\t\t}\n\n\t\t\t\tdelete $rootScope.controllers[ index ].image;\n\t\t        Utils.storage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t        $timeout( function() {\n\t\t\t\t\t$scope.$apply();\n\t\t        } );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfileInput.parent()[ 0 ].reset();\n\n\t\t\tfileInput.one( \"change\", function() {\n\t\t\t\tvar file = fileInput[ 0 ].files[ 0 ];\n\n\t\t\t\tif ( !file.type || !file.type.match( \"image.*\" ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar reader = new FileReader();\n\t\t\t\treader.onload = function( evt ) {\n\t\t\t\t\t$scope.data.image = evt.target.result;\n\t\t\t\t\t$scope.data.index = index;\n\t\t\t\t\t$scope.crop.show();\n\t\t\t\t};\n\t\t\t\treader.readAsDataURL( file );\n\t\t\t} );\n\n\t\t\tfileInput[ 0 ].click();\n\t\t};\n\n\t\t$scope.uploadPhoto = function( index ) {\n\t\t\t$scope.crop.hide();\n\n\t\t\tif ( $rootScope.controllers.indexOf( ( $filter( \"filter\" )( $rootScope.controllers, { \"mac\": $rootScope.activeController.mac } ) || [] )[ 0 ] ) === index ) {\n\t\t\t\t$rootScope.activeController.image = $scope.data.cropped;\n\t\t\t\tUtils.storage.set( { activeController: JSON.stringify( $rootScope.activeController ) } );\n\t\t\t}\n\n\t\t\t$rootScope.controllers[ index ].image = $scope.data.cropped;\n\t        Utils.storage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t        $timeout( function() {\n\t\t\t\t$scope.$apply();\n\t        } );\n\t\t};\n\t} )\n\n\t.controller( \"HistoryCtrl\", function( $scope, Utils ) {\n\t\t$scope.$on( \"$ionicView.beforeEnter\", function() {\n\t\t\tUtils.getLogs( function( reply ) {\n\t\t\t\tif ( reply ) {\n\t\t\t\t\t$scope.isLocal = true;\n\t\t\t\t\t$scope.logs = reply;\n\t\t\t\t} else {\n\t\t\t\t\t$scope.isLocal = false;\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t} )\n\n\t.controller( \"SettingsCtrl\", function( $scope, $state, $ionicPopup, Utils ) {\n\t\t$scope.settings = {};\n\n\t\t$scope.changePassword = Utils.changePassword;\n\t\t$scope.restart = Utils.restartController;\n\n\t\t$scope.submit = function() {\n\t\t\tUtils.saveOptions( $scope.settings, function( reply ) {\n\t\t\t\tvar text;\n\n\t\t\t\tif ( reply ) {\n\t\t\t\t\ttext = \"Settings saved successfully!\";\n\t\t\t\t\t$state.go( \"app.home\" );\n\t\t\t\t} else {\n\t\t\t\t\ttext = \"Unable to save settings. Please check the connection to the device and try again.\";\n\t\t\t\t}\n\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\ttemplate: \"<p class='center'>\" + text + \"</p>\"\n\t\t\t\t} );\n\t\t\t} );\n\t\t};\n\n\t\t$scope.$on( \"$ionicView.beforeEnter\", function() {\n\t\t\tUtils.getControllerOptions( function( reply ) {\n\t\t\t\tif ( reply ) {\n\t\t\t\t\t$scope.isLocal = true;\n\n\t\t\t\t\t// Remove unused options to prevent accidental change\n\t\t\t\t\tdelete reply.mod;\n\t\t\t\t\tdelete reply.fwv;\n\t\t\t\t\t$scope.settings = reply;\n\t\t\t\t} else {\n\t\t\t\t\t$scope.isLocal = false;\n\t\t\t\t}\n\t\t\t}, null, true );\n\t\t} );\n\t} )\n\n\t.controller( \"MenuCtrl\", function( $scope, $rootScope, $ionicActionSheet, $ionicPopup, $ionicSideMenuDelegate, Utils ) {\n\n\t\t$scope.showAddController = function() {\n\t\t\t$ionicActionSheet.show( {\n\t\t\t\tbuttons: [\n\t\t\t\t\t{ text: \"Add by IP\" },\n\t\t\t\t\t{ text: \"Add by Blynk Token\" },\n\t\t\t\t\t{ text: \"Setup New Device\" }\n\t\t\t\t],\n\t\t\t\ttitleText: \"Add Controller\",\n\t\t\t\tcancelText: \"Cancel\",\n\t\t\t\tbuttonClicked: function( index ) {\n\t\t\t\t\tif ( index === 1 ) {\n\t\t\t\t\t\tUtils.showAddBlynk();\n\t\t\t\t\t} else if ( index === 0 ) {\n\t\t\t\t\t\tUtils.showAddController();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$rootScope.$broadcast( \"loading:show\" );\n\t\t\t\t\t\tUtils.checkNewController( function( result ) {\n\t\t\t\t\t\t\t$rootScope.$broadcast( \"loading:hide\" );\n\t\t\t\t\t\t\tif ( !result ) {\n\t\t\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\t\t\ttemplate: \"<p class='center'>Please first connect the power to your OpenGarage. Once complete, connect this device to the wifi network broadcast by the OpenGarage (named OG_XXXXXX) and reopen this app.</p>\"\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\n\t\t// Function to close the menu which is fired after a side menu link is clicked.\n\t\t// This is done instead of using the menu-close directive to preserve the root history stack\n\t    $scope.closeMenu = function() {\n            $ionicSideMenuDelegate.toggleLeft( false );\n\t    };\n\t} )\n\n\t.controller( \"HomeCtrl\", function( $rootScope, $scope, $timeout, Utils ) {\n\t\tvar interval;\n\n\t\t$scope.toggleDoor = Utils.toggleDoor;\n\n\t\t$scope.$on( \"$ionicView.beforeLeave\", function() {\n\t\t\tclearInterval( interval );\n\t\t} );\n\n\t\t$scope.$on( \"$ionicView.beforeEnter\", function() {\n\t\t\tinterval = setInterval( Utils.updateController, 3000 );\n\t\t} );\n\n\t\t$rootScope.$on( \"controllerUpdated\", function() {\n\t\t\t$timeout( function() {\n\t\t\t\t$scope.$apply();\n\t\t\t} );\n\t\t} );\n\t} );\n\n/* global angular, window */\n\n// OpenGarage\nangular.module( \"opengarage.utils\", [] )\n    .factory( \"Utils\", [ \"$injector\", \"$rootScope\", function( $injector, $rootScope ) {\n\n\t\tvar isFireFox = /Firefox/.test( window.navigator.userAgent ),\n\t\t\tisIE = /MSIE\\s|Trident\\/|Edge\\//.test( window.navigator.userAgent ),\n\n\t        // Define storage wrapper functions\n\t        storage = {\n\t            get: function( query, callback ) {\n\t                callback = callback || function() {};\n\n                    var data = {},\n                        i;\n\n                    if ( typeof query === \"string\" ) {\n                        query = [ query ];\n                    }\n\n                    for ( i in query ) {\n                        if ( query.hasOwnProperty( i ) ) {\n                            data[ query[ i ] ] = localStorage.getItem( query[ i ] );\n                        }\n                    }\n\n                    callback( data );\n\t            },\n\t            set: function( query, callback ) {\n\t                callback = callback || function() {};\n\n                    var i;\n                    if ( typeof query === \"object\" ) {\n                        for ( i in query ) {\n                            if ( query.hasOwnProperty( i ) ) {\n                                localStorage.setItem( i, query[ i ] );\n                            }\n                        }\n                    }\n\n                    callback( true );\n\t            },\n\t            remove: function( query, callback ) {\n\t                callback = callback || function() {};\n\n                    var i;\n\n                    if ( typeof query === \"string\" ) {\n                        query = [ query ];\n                    }\n\n                    for ( i in query ) {\n                        if ( query.hasOwnProperty( i ) ) {\n                            localStorage.removeItem( query[ i ] );\n                        }\n                    }\n\n                    callback( true );\n\t            }\n\t        },\n\t\t\tintToIP = function( int ) {\n\t\t\t\treturn ( int % 256 ) + \".\" + ( ( int / 256 >> 0 ) % 256 ) + \".\" + ( ( ( int / 256 >> 0 ) / 256 >> 0 ) % 256 ) + \".\" + ( ( ( int / 256 >> 0 ) / 256 >> 0 ) / 256 >> 0 );\n\t\t\t},\n\t        getControllerSettings = function( callback, ip, token ) {\n\t\t\t\tif ( !ip && !token && !$rootScope.activeController ) {\n\t\t\t\t\tcallback( false );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\n\t\t\t\tvar promise;\n\n\t\t\t\tif ( token || ( !ip && ( $rootScope.activeController && $rootScope.activeController.auth ) ) ) {\n\t\t\t\t\tpromise = $http( {\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\turl: \"https://opensprinkler.com/wp-admin/admin-ajax.php\",\n\t\t                headers: { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" },\n\t\t\t\t\t\tdata: \"action=blynkCloud&path=\" + encodeURIComponent( token || $rootScope.activeController.auth ) + \"/query\",\n\t\t\t\t\t\tsuppressLoader: true\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tpromise = $http( {\n\t\t\t\t\t\tmethod: \"GET\",\n\t\t\t\t\t\turl: \"http://\" + ( ip || $rootScope.activeController.ip ) + \"/jc\",\n\t\t\t\t\t\tsuppressLoader: ip ? false : true\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t            return promise.then(\n\t\t\t\t\tfunction( result ) {\n\t\t\t\t\t\tif ( token || ( !ip && ( $rootScope.activeController && $rootScope.activeController.auth ) ) ) {\n\t\t\t\t\t\t\t$filter = $filter || $injector.get( \"$filter\" );\n\t\t\t\t\t\t\tvar filter = $filter( \"filter\" );\n\n\t\t\t\t\t\t\tresult = result.data[ 0 ];\n\t\t\t\t\t\t\tcallback( {\n\t\t\t\t\t\t\t\tname: result.name,\n\t\t\t\t\t\t\t\tdoor: parseInt( filter( result.pins, { \"pin\": 0 } )[ 0 ].value ),\n\t\t\t\t\t\t\t\tdist: parseInt( filter( result.pins, { \"pin\": 3 } )[ 0 ].value ),\n\t\t\t\t\t\t\t\trcnt: parseInt( filter( result.pins, { \"pin\": 4 } )[ 0 ].value ),\n\t\t\t\t\t\t\t\tlastUpdate: new Date().getTime()\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.data.lastUpdate = new Date().getTime();\n\t\t\t\t\t\t\tcallback( result.data );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\t\t\t\t);\n\t        },\n\t        getControllerOptions = function( callback, ip, showLoader ) {\n\t\t\t\tif ( ( !ip && !$rootScope.activeController ) || ( $rootScope.activeController && !$rootScope.activeController.ip ) ) {\n\t\t\t\t\tcallback( false );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\n\t            return $http( {\n\t                method: \"GET\",\n\t                url: \"http://\" + ( ip || $rootScope.activeController.ip ) + \"/jo\",\n\t                suppressLoader: showLoader ? false : true\n\t            } ).then(\n\t\t\t\t\tfunction( result ) {\n\t\t\t\t\t\tcallback( result.data );\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\t\t\t\t);\n\t        },\n\t        updateController = function() {\n\t\t\t\t$q = $q || $injector.get( \"$q\" );\n\t\t\t\t$filter = $filter || $injector.get( \"$filter\" );\n\n\t\t\t\tvar controller = angular.copy( $rootScope.activeController ),\n\t\t\t\t\tsave = function( data ) {\n\t\t\t\t\t\t$rootScope.connected = true;\n\t\t\t\t\t\tangular.extend( controller, data );\n\t\t\t\t\t};\n\n\t\t\t\t$q.when()\n\t\t\t\t\t.then( function() { return getControllerSettings( save ); } )\n\t\t\t\t\t.then( function() { return getControllerOptions( save ); } )\n\t\t\t\t\t.then( function() {\n\t\t\t\t\t\tvar index = $rootScope.controllers.indexOf( ( $filter( \"filter\" )( $rootScope.controllers, { \"mac\": controller.mac } ) || [] )[ 0 ] );\n\n\t\t\t\t\t\tif ( index >= 0 ) {\n\t\t\t\t\t\t\t$rootScope.controllers[ index ] = controller;\n\t\t\t\t\t\t\t$rootScope.activeController = controller;\n\t\t\t\t\t\t\t$rootScope.$broadcast( \"controllerUpdated\" );\n\t\t\t\t\t\t\tstorage.set( { \"controllers\": JSON.stringify( $rootScope.controllers ), \"activeController\": JSON.stringify( $rootScope.activeController ) } );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t        },\n\t\t\taddController = function( data, callback ) {\n\t\t\t\tcallback = callback || function() {};\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t\t\t\tif ( !data.token && ( !data.ip || !data.password ) ) {\n\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\ttemplate: \"<p class='center'>Both an IP and password are required.</p>\"\n\t\t\t\t\t} );\n\t\t\t\t\tcallback( false );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( data.token && data.token.length !== 32 ) {\n\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\ttemplate: \"<p class='center'>A valid Blynk token is required. Please verify your token and try again.</p>\"\n\t\t\t\t\t} );\n\t\t\t\t\tcallback( false );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tgetControllerSettings( function( result ) {\n\t\t\t\t\tif ( !result ) {\n\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\ttemplate: \"<p class='center'>Unable to find device. Please verify the IP/password and try again.</p>\"\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( result.mac ) {\n\t\t\t\t\t\tresult.ip = data.ip;\n\t\t\t\t\t\tresult.password = data.password;\n\n\t\t\t\t\t\t$filter = $filter || $injector.get( \"$filter\" );\n\n\t\t\t\t\t\tif ( $filter( \"filter\" )( $rootScope.controllers, { \"mac\": result.mac } ).length > 0 ) {\n\t\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\t\ttemplate: \"<p class='center'>Device already added to site list.</p>\"\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgetControllerOptions( function( reply ) {\n\t\t\t\t\t\t\tangular.extend( result, reply );\n\t\t\t\t\t\t\t$rootScope.controllers.push( result );\n\t\t\t\t\t\t\tstorage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t\t\t\t\t\tcallback( true );\n\t\t\t\t\t\t}, data.ip );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( data.token ) {\n\t\t\t\t\t\t$http( {\n\t\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\t\turl: \"https://opensprinkler.com/wp-admin/admin-ajax.php\",\n\t\t\t                headers: { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" },\n\t\t\t\t\t\t\tdata: \"action=blynkCloud&path=\" + data.token + \"/get/V2\",\n\t\t\t\t\t\t\tsuppressLoader: true\n\t\t\t\t\t\t} ).then( function( reply ) {\n\t\t\t\t\t\t\treply = reply.data.pop().split( \" \" )[ 1 ].split( \"_\" )[ 1 ];\n\t\t\t\t\t\t\tresult.mac = \"5C:CF:7F\" + reply.match( /.{1,2}/g ).join( \":\" );\n\t\t\t\t\t\t\tresult.auth = data.token;\n\n\t\t\t\t\t\t\tif ( $filter( \"filter\" )( $rootScope.controllers, { \"mac\": result.mac } ).length > 0 ) {\n\t\t\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\t\t\ttemplate: \"<p class='center'>Device already added to site list.</p>\"\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$rootScope.controllers.push( result );\n\t\t\t\t\t\t\tstorage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t\t\t\t\t\tcallback( true );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata.token ? null : data.ip,\n\t\t\t\tdata.token ? data.token : null\n\t\t\t\t);\n\t\t\t},\n\t\t\tcheckNewController = function( callback ) {\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\t\t\t\tcallback = callback || function() {};\n\t\t\t\t$ionicModal = $ionicModal || $injector.get( \"$ionicModal\" );\n\n\t            $http( {\n\t                method: \"GET\",\n\t                url: \"http://192.168.4.1/js\",\n\t                suppressLoader: true,\n\t\t\t\t\ttimeout: 5000,\n\t\t\t\t\tconfig: {\n\t\t\t\t\t\tretryCount: 0\n\t\t\t\t\t}\n\t            } ).then(\n\t\t\t\t\tfunction( result ) {\n\t\t\t\t\t\tif ( !result.data.ssids ) {\n\t\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar scope = $rootScope.$new();\n\t\t\t\t\t\tscope.data = {};\n\t\t\t\t\t\tscope.save = function() {\n\t\t\t\t\t\t\tscope.modal.hide();\n\t\t\t\t\t\t\tconnectNewController( scope.data );\n\t\t\t\t\t\t};\n\t\t\t\t\t\tscope.ssids = result.data.ssids;\n\t\t\t\t\t\t$ionicModal.fromTemplateUrl( \"templates/newControllerSetup.html\", {\n\t\t\t\t\t\t\tscope: scope,\n\t\t\t\t\t\t\tanimation: \"slide-in-up\"\n\t\t\t\t\t\t} ).then( function( modal ) {\n\t\t\t\t\t\t\tscope.modal = modal;\n\t\t\t\t\t\t\tmodal.show();\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tcallback( true );\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\tconnectNewController = function( data ) {\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t            $http( {\n\t                method: \"GET\",\n\t                url: \"http://192.168.4.1/cc?ssid=\" + encodeURIComponent( data.ssid ) + \"&pass=\" + encodeURIComponent( data.password )\n\t            } ).then(\n\t\t\t\t\tfunction( result ) {\n\t\t\t\t\t\tif ( result.data.result === 1 ) {\n\t\t\t\t\t\t\tsetTimeout( saveNewController, 2000 );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\t\ttemplate: \"<p class='center'>Invalid SSID/password combination. Please try again.</p>\"\n\t\t\t\t\t\t\t} ).then( checkNewController );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\ttemplate: \"<p class='center'>Unable to reach controller. Please try again.</p>\"\n\t\t\t\t\t\t} ).then( checkNewController );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\tsaveNewController = function() {\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t            $http( {\n\t                method: \"GET\",\n\t                url: \"http://192.168.4.1/jt\"\n\t            } ).then( function( result ) {\n\t\t\t\t\tif ( result.data.ip === 0 ) {\n\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\ttemplate: \"<p class='center'>Controller was unable to connect. Please check your SSID and password and try again.</p>\"\n\t\t\t\t\t\t} );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\ttemplate: \"<p class='center'>Controller succesfully connected! Please wait while the device reboots.</p>\"\n\t\t\t\t\t} );\n\n\t\t\t\t\t$rootScope.controllers.push( {\n\t\t\t\t\t\tip: intToIP( result.data.ip ),\n\t\t\t\t\t\tpassword: \"opendoor\",\n\t\t\t\t\t\tname: \"My OpenGarage\"\n\t\t\t\t\t} );\n\t\t\t\t\tstorage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t\t\t} );\n\t\t\t},\n\t\t\tscanLocalNetwork = function( callback ) {\n\t\t\t\tif ( !window.networkinterface ) {\n\t\t\t\t\tcallback( false );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\twindow.networkinterface.getIPAddress( function( router ) {\n\t\t\t\t\tif ( !router ) {\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$q = $q || $injector.get( \"$q\" );\n\t\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\t\t\t\t\trouter = router.split( \".\" );\n\t\t\t\t\trouter.pop();\n\n\t\t\t\t\tvar baseip = router.join( \".\" ),\n\t\t\t\t\t\tcheck = function( ip ) {\n\t\t\t\t\t\t\treturn $http( {\n\t\t\t\t\t\t\t\t\tmethod: \"GET\",\n\t\t\t\t\t\t\t\t\turl: \"http://\" + baseip + \".\" + ip + \"/jc\",\n\t\t\t\t\t\t\t\t\tsuppressLoader: true,\n\t\t\t\t\t\t\t\t\ttimeout: 6000,\n\t\t\t\t\t\t\t\t\tconfig: {\n\t\t\t\t\t\t\t\t\t\tretryCount: 0\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t.then( function( result ) {\n\t\t\t\t\t\t\t\t\tif ( result.data && result.data.mac ) {\n\t\t\t\t\t\t\t\t\t\tmatches.push( baseip + \".\" + ip );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t.catch( function() {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueue = [], matches = [], i;\n\n\t\t\t\t\t$rootScope.$broadcast( \"loading:show\" );\n\n\t\t\t\t    for ( i = 1; i <= 244; i++ ) {\n\t\t\t\t        queue.push( check( i ) );\n\t\t\t\t    }\n\n\t\t\t\t    $q.all( queue ).then( function() {\n\t\t\t\t\t\t$rootScope.$broadcast( \"loading:hide\" );\n\t\t\t\t\t\tcallback( matches );\n\t\t\t\t    } );\n\t\t\t\t} );\n\t\t\t},\n\t\t\trequestPassword = function( callback ) {\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t\t\t\t$ionicPopup.prompt( {\n\t\t\t\t\ttitle: \"Enter Controller Password\",\n\t\t\t\t\ttemplate: \"Enter your controller's password below:\",\n\t\t\t\t\tinputType: \"password\",\n\t\t\t\t\tinputPlaceholder: \"Controller Password\"\n\t\t\t\t} ).then( function( password ) {\n\t\t\t\t\tcallback( password );\n\t\t\t\t} );\n\t\t\t},\n\t\t\t$http, $q, $filter, $ionicPopup, $ionicModal;\n\n\t    if ( isFireFox ) {\n\t\t\tHTMLElement.prototype.click = function() {\n\t\t\t\tvar evt = this.ownerDocument.createEvent( \"MouseEvents\" );\n\t\t\t\tevt.initMouseEvent( \"click\", true, true, this.ownerDocument.defaultView, 1, 0, 0, 0, 0, false, false, false, false, 0, null );\n\t\t\t\tthis.dispatchEvent( evt );\n\t\t\t};\n\t    }\n\n\t    // Return usable functions\n\t    return {\n\t\t\tisIE: isIE,\n\t        storage: storage,\n\t        getControllerSettings: getControllerSettings,\n\t        getControllerOptions: getControllerOptions,\n\t        updateController: updateController,\n\t        checkNewController: checkNewController,\n\t\t\tshowAddController: function( callback ) {\n\t\t\t\tcallback = callback || function() {};\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t\t\t\tvar scope = $rootScope.$new();\n\t\t\t\tscope.data = {\n\t\t\t\t\tcanScan: window.networkinterface ? true : false\n\t\t\t\t};\n\t\t\t\tscope.scan = function() {\n\t\t\t\t\tscanLocalNetwork( function( result ) {\n\t\t\t\t\t\tif ( !result || !result.length ) {\n\t\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\t\ttemplate: \"<p class='center'>No devices detected on your network</p>\"\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tscope.data.foundControllers = result;\n\t\t\t\t\t} );\n\t\t\t\t};\n\t\t\t\tscope.save = function( ip ) {\n\t\t\t\t\tpopup.close();\n\t\t\t\t\trequestPassword( function( password ) {\n\t\t\t\t\t\taddController( {\n\t\t\t\t\t\t\tip: ip,\n\t\t\t\t\t\t\tpassword: password\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t};\n\n\t\t\t\tvar popup = $ionicPopup.show( {\n\t\t\t\t\ttemplateUrl: \"templates/addController.html\",\n\t\t\t\t\ttitle: \"Add Controller\",\n\t\t\t\t\tscope: scope,\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t{ text: \"Cancel\" },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: \"<b>Add</b>\",\n\t\t\t\t\t\t\ttype: \"button-positive\",\n\t\t\t\t\t\t\tonTap: function( e ) {\n\t\t\t\t\t\t\t\tif ( !scope.data.ip || !scope.data.password ) {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\tpopup.then(\n\t\t\t\t\tfunction( isValid ) {\n\t\t\t\t\t\tif ( isValid ) {\n\t\t\t\t\t\t\taddController( scope.data, callback );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\tshowAddBlynk: function( callback ) {\n\t\t\t\tcallback = callback || function() {};\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t\t\t\t$ionicPopup.prompt( {\n\t\t\t\t\ttitle: \"Add Controller by Blynk\",\n\t\t\t\t\ttemplate: \"Enter your Blynk Auth token below:\",\n\t\t\t\t\tinputType: \"text\",\n\t\t\t\t\tinputPlaceholder: \"Your Blynk Auth token\"\n\t\t\t\t} ).then( function( token ) {\n\t\t\t\t\tif ( token ) {\n\t\t\t\t\t\taddController( { token: token }, callback );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t},\n\t\t\ttoggleDoor: function( callback ) {\n\t\t\t\tcallback = callback || function() {};\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\n\t\t\t\tvar promise;\n\n\t\t\t\tif ( $rootScope.activeController && $rootScope.activeController.auth ) {\n\t\t\t\t\t$rootScope.$broadcast( \"loading:show\" );\n\t\t\t\t\tpromise = $http( {\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\turl: \"https://opensprinkler.com/wp-admin/admin-ajax.php\",\n\t\t                headers: { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" },\n\t\t\t\t\t\tdata: \"action=blynkCloud&path=\" + encodeURIComponent( $rootScope.activeController.auth + \"/update/V1?value=1\" ),\n\t\t\t\t\t\tsuppressLoader: true\n\t\t\t\t\t} ).then( function() {\n\t\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\t\t$http( {\n\t\t\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\t\t\turl: \"https://opensprinkler.com/wp-admin/admin-ajax.php\",\n\t\t\t\t                headers: { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" },\n\t\t\t\t\t\t\t\tdata: \"action=blynkCloud&path=\" + encodeURIComponent( $rootScope.activeController.auth + \"/update/V1?value=0\" ),\n\t\t\t\t\t\t\t\tsuppressLoader: true\n\t\t\t\t\t\t\t} ).then( function() {\n\t\t\t\t\t\t\t\t$rootScope.$broadcast( \"loading:hide\" );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}, 1000 );\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tpromise = $http.get( \"http://\" + $rootScope.activeController.ip + \"/cc?dkey=\" + encodeURIComponent( $rootScope.activeController.password ) + \"&click=1\" );\n\t\t\t\t}\n\n\t            promise.then(\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tcallback( true );\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\trestartController: function() {\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t\t\t\tif ( $rootScope.activeController ) {\n\t\t\t\t\t$ionicPopup.confirm( {\n\t\t\t\t\t\ttitle: \"Restart Controller?\",\n\t\t\t\t\t\ttemplate: \"<p class='center'>Are you sure you want to restart the controller?</p>\"\n\t\t\t\t\t} ).then( function( result ) {\n\t\t\t\t\t\tif ( result ) {\n\t\t\t\t\t\t\t$http.get( \"http://\" + $rootScope.activeController.ip + \"/cc?dkey=\" + encodeURIComponent( $rootScope.activeController.password ) + \"&reboot=1\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t},\n\t\t\tsaveOptions: function( settings, callback ) {\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\n\t            return $http( {\n\t                method: \"GET\",\n\t                url: \"http://\" + $rootScope.activeController.ip + \"/co?dkey=\" + $rootScope.activeController.password,\n\t\t\t\t\tparams: settings,\n\t\t\t\t\tparamSerializer: \"$httpParamSerializerJQLike\"\n\t            } ).then(\n\t\t\t\t\tfunction( result ) {\n\t\t\t\t\t\tcallback( result.data );\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\tchangePassword: function() {\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t\t\t\tvar scope = $rootScope.$new();\n\t\t\t\tscope.pwd = {};\n\n\t\t\t\t$ionicPopup.show( {\n\t\t\t\t\ttemplateUrl: \"templates/changePassword.html\",\n\t\t\t\t\ttitle: \"Change Password\",\n\t\t\t\t\tscope: scope,\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t{ text: \"Cancel\" },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: \"<b>Go</b>\",\n\t\t\t\t\t\t\ttype: \"button-positive\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t} ).then( function() {\n\t\t\t\t\tif ( !scope.pwd.nkey || !scope.pwd.ckey || scope.pwd.nkey !== scope.pwd.ckey  ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\n\t\t            $http( {\n\t\t                method: \"GET\",\n\t\t                url: \"http://\" + $rootScope.activeController.ip + \"/co?dkey=\" + $rootScope.activeController.password,\n\t\t\t\t\t\tparams: scope.pwd,\n\t\t\t\t\t\tparamSerializer: \"$httpParamSerializerJQLike\"\n\t\t            } ).then( function() {\n\t\t\t\t\t\t$rootScope.activeController.password = scope.pwd.nkey;\n\n\t\t\t\t\t\tvar index = $rootScope.controllers.indexOf( ( $filter( \"filter\" )( $rootScope.controllers, { \"mac\": $rootScope.activeController.mac } ) || [] )[ 0 ] );\n\t\t\t\t\t\tif ( index ) {\n\t\t\t\t\t\t\t$rootScope.controllers[ index ] = $rootScope.activeController;\n\t\t\t\t\t\t\tstorage.set( { \"controllers\": JSON.stringify( $rootScope.controllers ), \"activeController\": JSON.stringify( $rootScope.activeController ) } );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\ttemplate: \"<p class='center'>Password updated succesfully!</p>\"\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t},\n\t\t\tgetLogs: function( callback ) {\n\t\t\t\tif ( !$rootScope.activeController || !$rootScope.activeController.ip ) {\n\t\t\t\t\tcallback( false );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\n\t            $http( {\n\t                method: \"GET\",\n\t                url: \"http://\" + $rootScope.activeController.ip + \"/jl\"\n\t            } ).then(\n\t\t\t\t\tfunction( result ) {\n\t\t\t\t\t\tcallback( result.data.logs.sort( function( a, b ) { return b[ 0 ] - a[ 0 ]; } ) );\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t    };\n} ] );\n"],"sourceRoot":"/source/"}