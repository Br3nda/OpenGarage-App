{"version":3,"sources":["app.min.js"],"names":["angular","module","run","$state","$ionicPlatform","$ionicScrollDelegate","$ionicHistory","$location","$document","$window","$rootScope","$ionicLoading","$ionicPopup","$timeout","Utils","ready","open","url","window","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","StatusBar","styleLightContent","backgroundColorByHexString","element","on","scrollTop","Intercom","hide","show","navigator","splashscreen","err","version","appVersion","loadingCount","controllers","$on","e","data","canceller","resolve","template","title","firstLoadHandler","event","preventDefault","storage","get","JSON","parse","activeController","go","$broadcast","innerWidth","width","config","$stateProvider","$urlRouterProvider","$httpProvider","$compileProvider","$ionicConfigProvider","test","userAgent","platform","spinner","icon","backButton","previousTitleText","text","scrolling","jsScrolling","aHrefSanitizationWhitelist","imgSrcSanitizationWhitelist","state","abstract","templateUrl","controller","views","menuContent","checkValid","$q","$filter","total","length","filterFilter","invalidOrg","mac","remove","reject","set","stringify","interceptors","push","$injector","request","indexOf","ip","suppressLoader","defer","timeout","promise","retryCount","response","responseError","error","isAPI","$$state","status","canceled","$http","retryFailed","forwardCache","$scope","showDelete","setController","index","nextViewOptions","historyRoot","deleteController","splice","moveItem","item","fromIndex","toIndex","pageTitle","$ionicSideMenuDelegate","showAddController","closeMenu","toggleLeft","changing","toggleDoor","result","factory","isFireFox","isIE","query","callback","i","hasOwnProperty","localStorage","getItem","setItem","removeItem","addController","password","method","then","fwv","alert","HTMLElement","prototype","click","evt","this","ownerDocument","createEvent","initMouseEvent","defaultView","dispatchEvent","scope","$new","buttons","type","onTap","isValid","encodeURIComponent"],"mappings":"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","file":"app.min.js","sourcesContent":["/* global angular */\n\n// OpenGarage\n// Controllers are found in controllers.js and utilities are located in utils.js\nangular.module( \"opengarage\", [ \"ionic\", \"opengarage.controllers\", \"opengarage.utils\" ] )\n\t.run( function( $state, $ionicPlatform, $ionicScrollDelegate, $ionicHistory, $location, $document, $window, $rootScope, $ionicLoading, $ionicPopup, $timeout, Utils ) {\n\n\t\t// Ready function fires when the DOM is ready and after deviceready event is fired if Cordova is being used\n\t\t$ionicPlatform.ready( function() {\n\n\t\t\t// Map inAppBrowser to rootScope\n\t\t\t$rootScope.open = function( url ) {\n\t\t\t\twindow.open( url, \"_blank\", \"toolbarposition=top\" );\n\t\t\t};\n\n\t\t\t// Hide the accessory bar by default (remove this to show the accessory bar above the keyboard\n\t\t\t// for form inputs)\n\t\t\tif ( window.cordova && window.cordova.plugins && window.cordova.plugins.Keyboard && window.cordova.plugins.Keyboard.hideKeyboardAccessoryBar ) {\n\t\t\t\twindow.cordova.plugins.Keyboard.hideKeyboardAccessoryBar( true );\n\t\t\t}\n\t\t\tif ( window.StatusBar ) {\n\n\t\t\t\t// Use white text/icons on the status bar\n\t\t        window.StatusBar.styleLightContent();\n\n\t\t        //Change the status bar color to match the header\n                window.StatusBar.backgroundColorByHexString( \"#444\" );\n\n\t\t        // Scroll to the top of the page when the status bar is tapped\n\t\t\t\tangular.element( $window ).on( \"statusTap\", function() {\n\t\t\t\t\t$ionicScrollDelegate.scrollTop();\n\t\t        } );\n\n\t\t\t\tif ( window.Intercom ) {\n\t\t\t        window.Intercom( \"onShow\", function() {\n\t\t\t\t\t\twindow.StatusBar.hide();\n\t\t\t        } );\n\t\t\t        window.Intercom( \"onHide\", function() {\n\t\t\t\t        window.StatusBar.show();\n\t\t\t        } );\n\t\t\t    }\n\t\t\t}\n\n\t\t    // Hide the splash screen after 500ms of the app being ready\n\t\t    $timeout( function() {\n\t\t        try {\n\t\t            navigator.splashscreen.hide();\n\t\t        } catch ( err ) {}\n\t\t    }, 500 );\n\t\t} );\n\n\t\t// Define version, build number and debug state\n\t\t$rootScope.version = window.appVersion;\n\n\t    // Define total loading requests\n\t    $rootScope.loadingCount = 0;\n\n\t    // Initialize controllers array\n\t    $rootScope.controllers = [];\n\n\t\t// Automatically show a loading message on any AJAX request\n\t\t$rootScope.$on( \"loading:show\", function( e, data ) {\n\n\t\t\t$rootScope.loadingCount++;\n\t\t\t$rootScope.canceller = data.canceller.resolve;\n\t\t\t$ionicLoading.show( {\n\t\t\t\ttemplate: \"<ion-spinner></ion-spinner><br>One moment please<br><button class='button white icon-left ion-ios-close-outline button-clear' ng-click='$root.canceller()'>Cancel</button>\"\n\t\t\t} );\n\t\t} );\n\n\t\t// Automatically hide the loading message after an AJAX request\n\t\t$rootScope.$on( \"loading:hide\", function() {\n\n\t\t\t$rootScope.loadingCount--;\n\t\t\tif ( $rootScope.loadingCount <= 0 ) {\n\t\t\t\t$rootScope.loadingCount = 0;\n\t\t\t\t$ionicLoading.hide();\n\t\t\t}\n\t\t} );\n\n\t\t// Keep the page title locked as the app name\n\t\t$rootScope.$on( \"$ionicView.afterEnter\", function() {\n\t\t\t$document[ 0 ].title = \"OpenGarage\";\n\t\t} );\n\n\t\t// Handle loading of the first page\n\t\tvar firstLoadHandler = $rootScope.$on( \"$stateChangeStart\", function( event ) {\n\n\t\t\t// Unbind event handler so this check is only performed on the first app load\n\t\t    firstLoadHandler();\n\n\t\t    // Prevent any page change from occurring\n\t        event.preventDefault();\n\n\t\t    Utils.storage.get( [ \"activeController\", \"controllers\" ], function( data ) {\n\n\t\t\t\ttry {\n\t\t\t\t\t$rootScope.controllers = JSON.parse( data.controllers );\n\t\t\t\t\t$rootScope.activeController = JSON.parse( data.activeController );\n\t\t\t\t} catch ( err ) {}\n\n\t\t\t\tif ( !$rootScope.controllers ) {\n\t\t\t\t\t$rootScope.controllers = [];\n\t\t\t\t}\n\n\t\t\t\t// Restore the active controller, if available\n\t\t        if ( $rootScope.activeController && typeof $rootScope.activeController === \"object\" ) {\n\n\t\t\t\t\t// If a user object is cached, proceed to load the app while updating user object in the background\n\t\t\t\t\t$state.go( \"app.home\" );\n\t\t        } else {\n\t\t\t\t\t$state.go( \"app.controllerSelect\" );\n\t\t        }\n\t\t    } );\n\t\t} );\n\n\t\t// Resize the main content view to fit when the window changes size\n\t\tangular.element( window ).on( \"resize\", function() {\n\t\t\t$rootScope.$broadcast( \"window:resize\" );\n\t\t\tif ( window.innerWidth > 768 ) {\n\t\t\t\tangular.element( \"#mainContent\" ).width( window.innerWidth - 275 );\n\t\t\t}\n\t\t} );\n\t} )\n\n\t.config( function( $stateProvider, $urlRouterProvider, $httpProvider, $compileProvider, $ionicConfigProvider ) {\n\n\t\tif ( /MSIE\\s|Trident\\/|Edge\\//.test( window.navigator.userAgent ) ) {\n\n\t\t\t// Change the default spinner for IE to android which has JS based animation\n\t\t\t$ionicConfigProvider.platform.default.spinner.icon( \"android\" );\n\t\t}\n\n\t\t// Change the back text to always say 'Back'\n\t\t$ionicConfigProvider.backButton.previousTitleText( false ).text( \"Back\" );\n\n\t\t// Use native scrolling for FireFox\n\t\tif ( /Firefox/.test( navigator.userAgent ) ) {\n\t\t\t$ionicConfigProvider.scrolling.jsScrolling( false );\n\t\t}\n\n\t\t// Modify Ionic's allowed href protocols to allow Firefox, Blackberry, iOS and Chrome support\n\t\t$compileProvider.aHrefSanitizationWhitelist( /^\\s*(https?|ftp|mailto|chrome-extension|app|local|file):/ );\n\n\t\t// Modify Ionic's allowed image source protocols\n\t\t$compileProvider.imgSrcSanitizationWhitelist( /^\\s*(https?|ftp|file|content|blob|ms-appx|x-wmapp0|chrome-extension|app|local):|data:image\\// );\n\n\t\t// Define all available routes and their associated controllers\n\t\t$stateProvider\n\n\t\t\t// Used as the parent route after authentication is complete allowing the same header\n\t\t\t// and side menu's to be used throughout all child views\n\t\t\t.state( \"app\", {\n\t\t\t\turl: \"/app\",\n\t\t\t\tabstract: true,\n\t\t\t\ttemplateUrl: \"templates/menu.html\",\n\t\t\t\tcontroller: \"MenuCtrl\"\n\t\t\t} )\n\n\t\t\t.state( \"app.home\", {\n\t\t\t\turl: \"/home\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/home.html\",\n\t\t\t\t\t\tcontroller: \"HomeCtrl\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcheckValid: function( $timeout, $q, $state, $rootScope, $filter, Utils ) {\n\t\t\t\t\t\tvar total = $rootScope.controllers.length,\n\t\t\t\t\t\t\tfilterFilter = $filter( \"filter\" ),\n\t\t\t\t\t\t\tinvalidOrg = ( $rootScope.activeController && filterFilter( $rootScope.controllers, { \"mac\": $rootScope.activeController.mac } ).length === 0 ) ? true : false;\n\n\t\t\t\t\t\tif ( !$rootScope.activeController && total === 1 ) {\n\t\t\t\t\t\t\t$rootScope.activeController = $rootScope.controllers[ 0 ];\n\t\t\t\t\t\t\tUtils.storage.set( { activeController: JSON.stringify( $rootScope.activeController ) } );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( !$rootScope.activeController || invalidOrg ) {\n\n\t\t\t\t\t\t\tdelete $rootScope.activeController;\n\t\t\t\t\t\t\tUtils.storage.remove( \"activeController\" );\n\n\t\t\t\t\t\t\t// If the active controller is not found in the controller list, show the select controller screen\n\t\t\t\t\t\t\t$timeout( function() {\n\t\t\t\t\t\t\t\t$state.go( \"app.controllerSelect\" );\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\treturn $q.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t.state( \"app.controllerSelect\", {\n\t\t\t\turl: \"/controllerSelect\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/controllerSelect.html\",\n\t\t\t\t\t\tcontroller: \"ControllerSelectCtrl\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t.state( \"app.settings\", {\n\t\t\t\turl: \"/settings\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/settings.html\",\n\t\t\t\t\t\tcontroller: \"SettingsCtrl\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcheckValid: function( $rootScope, $q ) {\n\t\t\t\t\t\tif ( !$rootScope.activeController ) {\n\t\t\t\t\t\t\treturn $q.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t.state( \"app.help\", {\n\t\t\t\turl: \"/help\",\n\t\t\t\tviews: {\n\t\t\t\t\tmenuContent: {\n\t\t\t\t\t\ttemplateUrl: \"templates/help.html\",\n\t\t\t\t\t\tcontroller: \"HelpCtrl\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t// Defines the otherwise route which will redirect any invalid URL back to the start page\n\t\t\t.state( \"otherwise\", {\n\t\t\t\turl: \"*path\",\n\t\t\t\ttemplate: \"\",\n\t\t\t\tcontroller: function( $state, $rootScope ) {\n\n\t\t\t\t\tif ( $rootScope.activeController ) {\n\t\t\t\t\t\t$state.go( \"app.home\" );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$state.go( \"app.controllerSelect\" );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t// Add an HTTP interceptor\n\t\t$httpProvider.interceptors.push( function( $rootScope, $q, $injector ) {\n\t\t\treturn {\n\t\t\t\trequest: function( config ) {\n\n\t\t\t\t\t// When an AJAX request to the API is started, fire an event to show a loading message\n\t\t\t\t\tif ( $rootScope.activeController && config.url.indexOf( $rootScope.activeController.ip ) !== -1 && !config.suppressLoader ) {\n\n\t\t\t\t\t\t// Change timeout to a promise we can cancel\n\t\t\t\t\t\tvar canceller = $q.defer();\n\n\t\t\t\t\t\t// Set the timeout to the canceller promise\n\t\t\t\t\t\tconfig.timeout = canceller.promise;\n\n\t\t\t\t\t\t// Set the current retry count to 0\n\t\t\t\t\t\tif ( typeof config.retryCount !== \"number\" ) {\n\t\t\t\t\t\t\tconfig.retryCount = 0;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$rootScope.$broadcast( \"loading:show\", { canceller: canceller } );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn config;\n\t\t\t\t},\n\t\t\t\tresponse: function( response ) {\n\n\t\t\t\t\t// If the request is to the API, broadcast a hide loading message\n\t\t\t\t\tif ( $rootScope.activeController && response.config.url.indexOf( $rootScope.activeController.ip ) !== -1 ) {\n\n\t\t\t\t\t\tif ( !response.config.suppressLoader ) {\n\t\t\t\t\t\t\t$rootScope.$broadcast( \"loading:hide\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn response;\n\t\t\t\t},\n\t\t\t\tresponseError: function( error ) {\n\n\t\t\t\t\tvar isAPI = $rootScope.activeController && error.config.url.indexOf( $rootScope.activeController.ip ) !== -1 ? true : false;\n\n\t\t\t\t\t// If the timeout value is an object and is resolved, mark request as user canceled\n\t\t\t\t\tif ( error.config.timeout && error.config.timeout.$$state && error.config.timeout.$$state.status === 1 ) {\n\t\t\t\t\t\terror.canceled = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t// If the request is to the API, broadcast a hide loading message\n\t\t\t\t\tif ( isAPI ) {\n\t\t\t\t\t\tif ( !error.config.suppressLoader ) {\n\t\t\t\t\t\t\t$rootScope.$broadcast( \"loading:hide\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If the request timed out and is not user canceled, retry the request up to three times\n\t\t\t\t\tif ( error.status <= 0 && !error.canceled ) {\n\t\t\t\t\t\tif ( error.config.retryCount < 3 ) {\n\t\t\t\t\t\t\tvar $http = $injector.get( \"$http\" );\n\n\t\t\t\t\t\t\terror.config.retryCount++;\n\n\t\t\t\t\t\t\t// Return the new promise object\n\t\t\t\t\t\t\treturn $http( error.config );\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// After three timeouts, assume the network is down\n\t\t\t\t\t\t\terror.retryFailed = true;\n\t\t\t\t\t\t\terror.canceled = true;\n\n\t\t\t\t\t\t\treturn $q.reject( error );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn $q.reject( error );\n\t\t\t\t}\n\t\t\t};\n\t\t} );\n\n\t\t// Inform Ionic we want to cache forward views\n\t\t$ionicConfigProvider.views.forwardCache( true );\n\t} );\n\n/* global angular */\n\nangular.module( \"opengarage.controllers\", [ \"opengarage.utils\" ] )\n\n\t.controller( \"ControllerSelectCtrl\", function( $scope, $state, $rootScope, $filter, $ionicHistory, Utils ) {\n\t\t$scope.data = {\n\t\t\tshowDelete: false\n\t\t};\n\n\t\t$scope.setController = function( index ) {\n\t\t\t$rootScope.activeController = $rootScope.controllers[ index ];\n\t\t\tUtils.storage.set( { activeController: JSON.stringify( $rootScope.activeController ) } );\n\n\t\t\t$ionicHistory.nextViewOptions( {\n\t\t\t\thistoryRoot: true\n\t\t\t} );\n\n\t\t\t$state.go( \"app.home\" );\n\t\t};\n\n\t\t$scope.deleteController = function( index ) {\n\t\t\t$rootScope.controllers.splice( index, 1 );\n\t\t\tUtils.storage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t};\n\n\t\t$scope.moveItem = function( item, fromIndex, toIndex ) {\n\t\t\t$rootScope.controllers.splice( fromIndex, 1 );\n\t\t\t$rootScope.controllers.splice( toIndex, 0, item );\n\t\t\tUtils.storage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t};\n\n\t\t// Update each time the page is viewed\n\t\t$scope.$on( \"$ionicView.beforeEnter\", function() {\n\t\t\tif ( $rootScope.activeController ) {\n\t\t\t\t$scope.data.pageTitle = \"Switch Controller\";\n\t\t\t} else {\n\t\t\t\t$scope.data.pageTitle = \"Select Controller\";\n\t\t\t}\n\t\t} );\n\t} )\n\n\t.controller( \"SettingsCtrl\", function() {\n\t} )\n\n\t.controller( \"HelpCtrl\", function() {\n\t} )\n\n\t.controller( \"MenuCtrl\", function( $scope, $ionicSideMenuDelegate, Utils ) {\n\n\t\t$scope.showAddController = Utils.showAddController;\n\n\t\t// Function to close the menu which is fired after a side menu link is clicked.\n\t\t// This is done instead of using the menu-close directive to preserve the root history stack\n\t    $scope.closeMenu = function() {\n            $ionicSideMenuDelegate.toggleLeft( false );\n\t    };\n\t} )\n\n\t.controller( \"HomeCtrl\", function( $scope, Utils ) {\n\t\t$scope.changing = false;\n\n\t\t$scope.toggleDoor = function() {\n\t\t\t$scope.changing = true;\n\n\t\t\tUtils.toggleDoor( function( result ) {\n\t\t\t\t$scope.changing = false;\n\t\t\t} );\n\t\t};\n\t} );\n\n/* global angular, window */\n\n// OpenGarage\nangular.module( \"opengarage.utils\", [] )\n    .factory( \"Utils\", [ \"$injector\", \"$rootScope\", function( $injector, $rootScope ) {\n\n\t\tvar isFireFox = /Firefox/.test( window.navigator.userAgent ),\n\t\t\tisIE = /MSIE\\s|Trident\\/|Edge\\//.test( window.navigator.userAgent ),\n\n\t        // Define storage wrapper functions\n\t        storage = {\n\t            get: function( query, callback ) {\n\t                callback = callback || function() {};\n\n                    var data = {},\n                        i;\n\n                    if ( typeof query === \"string\" ) {\n                        query = [ query ];\n                    }\n\n                    for ( i in query ) {\n                        if ( query.hasOwnProperty( i ) ) {\n                            data[ query[ i ] ] = localStorage.getItem( query[ i ] );\n                        }\n                    }\n\n                    callback( data );\n\t            },\n\t            set: function( query, callback ) {\n\t                callback = callback || function() {};\n\n                    var i;\n                    if ( typeof query === \"object\" ) {\n                        for ( i in query ) {\n                            if ( query.hasOwnProperty( i ) ) {\n                                localStorage.setItem( i, query[ i ] );\n                            }\n                        }\n                    }\n\n                    callback( true );\n\t            },\n\t            remove: function( query, callback ) {\n\t                callback = callback || function() {};\n\n                    var i;\n\n                    if ( typeof query === \"string\" ) {\n                        query = [ query ];\n                    }\n\n                    for ( i in query ) {\n                        if ( query.hasOwnProperty( i ) ) {\n                            localStorage.removeItem( query[ i ] );\n                        }\n                    }\n\n                    callback( true );\n\t            }\n\t        },\n\t\t\taddController = function( data, callback ) {\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t\t\t\tif ( !data.ip || !data.password ) {\n\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\ttemplate: \"<p class='center'>Both an IP and password are required.</p>\"\n\t\t\t\t\t} );\n\t\t\t\t\tcallback( false );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\n\t            $http( {\n\t                method: \"GET\",\n\t                url: \"http://\" + data.ip + \"/jc\"\n\t            } ).then(\n\t\t\t\t\tfunction( result ) {\n\t\t\t\t\t\tif ( result.data.fwv ) {\n\t\t\t\t\t\t\tresult.data.ip = data.ip;\n\t\t\t\t\t\t\tresult.data.password = data.password;\n\t\t\t\t\t\t\t$rootScope.controllers.push( result.data );\n\t\t\t\t\t\t\tstorage.set( { controllers: JSON.stringify( $rootScope.controllers ) } );\n\t\t\t\t\t\t\tcallback( true );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\t$ionicPopup.alert( {\n\t\t\t\t\t\t\ttemplate: \"<p class='center'>Unable to find device. Please verify the IP/password and try again.</p>\"\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\t$http, $ionicPopup;\n\n\t    if ( isFireFox ) {\n\t\t\tHTMLElement.prototype.click = function() {\n\t\t\t\tvar evt = this.ownerDocument.createEvent( \"MouseEvents\" );\n\t\t\t\tevt.initMouseEvent( \"click\", true, true, this.ownerDocument.defaultView, 1, 0, 0, 0, 0, false, false, false, false, 0, null );\n\t\t\t\tthis.dispatchEvent( evt );\n\t\t\t};\n\t    }\n\n\t    // Return usable functions\n\t    return {\n\t\t\tisIE: isIE,\n\t        storage: storage,\n\t\t\tshowAddController: function( callback ) {\n\t\t\t\tcallback = callback || function() {};\n\t\t\t\t$ionicPopup = $ionicPopup || $injector.get( \"$ionicPopup\" );\n\n\t\t\t\tvar scope = $rootScope.$new();\n\t\t\t\tscope.data = {};\n\n\t\t\t\t$ionicPopup.show( {\n\t\t\t\t\ttemplateUrl: \"templates/addController.html\",\n\t\t\t\t\ttitle: \"Add Controller\",\n\t\t\t\t\tscope: scope,\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t{ text: \"Cancel\" },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: \"<b>Add</b>\",\n\t\t\t\t\t\t\ttype: \"button-positive\",\n\t\t\t\t\t\t\tonTap: function( e ) {\n\t\t\t\t\t\t\t\tif ( !scope.data.ip || !scope.data.password ) {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t} ).then(\n\t\t\t\t\tfunction( isValid ) {\n\t\t\t\t\t\tif ( isValid ) {\n\t\t\t\t\t\t\taddController( scope.data, callback );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\ttoggleDoor: function( callback ) {\n\t\t\t\tcallback = callback || function() {};\n\t\t\t\t$http = $http || $injector.get( \"$http\" );\n\n\t            $http( {\n\t                method: \"GET\",\n\t                url: \"http://\" + $rootScope.activeController.ip + \"/cc?dkey=\" + encodeURIComponent( $rootScope.activeController.password ) + \"click=1\"\n\t            } ).then(\n\t\t\t\t\tfunction( result ) {\n\t\t\t\t\t\tcallback( true );\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tcallback( false );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t    };\n} ] );\n"],"sourceRoot":"/source/"}